
<button mdbBtn type="button" color="success" mdbWavesEffect *ngIf="editable && lineup.changed" (click)="_updateRosterRecord()">Save Changes</button>


<div class="container example-table-container example-list" cdkDropList [cdkDropListDisabled]=!editable (cdkDropListDropped)="dropLineupRecord($event)" >

  <table mat-table [dataSource]="(dispRoster$ | async)" class="roster-table" >

    <ng-container matColumnDef="player.name" >
      <th mat-header-cell *matHeaderCellDef >Player</th>
      <td mat-cell *matCellDef="let rosterRec"> {{ rosterRec.player.name }} ({{ rosterRec.player.team }} - {{rosterRec.player.eligible?.join()}})
        <span *ngIf="rosterRec.player.ablstatus.acqType == 'pickup' ">
          Pickup

        </span>
        <button *ngIf="editable && dropPlayerAllowed(rosterRec)" mdbBtn type="button" color="danger" mdbWavesEffect (click)="_dropPlyr(rosterRec.player._id)">Drop</button>
      </td>
    </ng-container>
    <ng-container matColumnDef="player.drop">
      <th mat-header-cell *matHeaderCellDef><th>
      <td mat-cell *matCellDef="let rosterRec">

      </td>
    </ng-container>
    <ng-container matColumnDef="player.status">
      <th mat-header-cell *matHeaderCellDef>Status<th>

        <td mat-cell *matCellDef="let rosterRec">
          <span class="badge bg-danger" *ngIf="!rosterRec.player.status">{{'No current status. Not on 40-Man roster.'}}</span>
            {{rosterRec.player.status}}
      </td>
    </ng-container>
    <ng-container matColumnDef="lineupPosition" >
        <th mat-header-cell *matHeaderCellDef >Position</th>
        <td mat-cell *matCellDef="let rosterRec">

          <mat-select [disabled]="!editable" panelClass="myPanel" *ngIf="(editable && rosterRec.player.eligible.length > 1 ) || (rosterRec.player.eligible[0] != rosterRec.lineupPosition)" [(ngModel)]="rosterRec.lineupPosition" (selectionChange)="changePos($event)" >
            <mat-option *ngFor="let pos of rosterRec.player.eligible" [value]="pos">{{pos}}</mat-option>
          </mat-select>


<!--
            <select [(ngModel)]="rosterRec.lineupPosition" *ngIf="editable && rosterRec.player.eligible.length > 1" (onchange)="changePos($event)">
                <option *ngFor="let pos of rosterRec.player.eligible"  [value]="pos">{{pos}}</option>
            </select> -->
            <span *ngIf="!editable || rosterRec.player.eligible.length <= 1">{{rosterRec.lineupPosition}}</span>

        </td>
      </ng-container>
      <ng-container matColumnDef="drag_handle">
        <th mat-header-cell *matHeaderCellDef>Move</th>
        <td mat-cell *matCellDef="let rosterRec">
          <span *ngIf="editable" class=" example-handle " cdkDragHandle><mat-icon> drag_handle</mat-icon></span>
        </td>
      </ng-container>
      <ng-container matColumnDef="abl_runs" >
        <th mat-header-cell *matHeaderCellDef >ABL</th>
        <td mat-cell *matCellDef="let rosterRec">{{ rosterRec.player.abl  | number:'1.2-2' }}</td>
      </ng-container>
      <ng-container matColumnDef="stats" >
        <th mat-header-cell *matHeaderCellDef >Stats</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.gamesPlayed}} G,
            {{rosterRec.player.stats?.batting?.atBats}} AB,
            {{rosterRec.player.stats?.batting?.hits}} H,
            {{rosterRec.player.stats?.batting?.doubles}} 2B,
            {{rosterRec.player.stats?.batting?.triples}} 3B,
            {{rosterRec.player.stats?.batting?.homeRuns}} HR,
            {{rosterRec.player.stats?.batting?.baseOnBalls + rosterRec.player.stats?.batting?.intentionalWalks}} BB/IBB,
            {{rosterRec.player.stats?.batting?.hitByPitch}} HBP,
            {{rosterRec.player.stats?.batting?.stolenBases}} SB,
            {{rosterRec.player.stats?.batting?.caughtStealing}} CS
            </span>
        </td>
      </ng-container>

      <ng-container matColumnDef="player.stats.batting.gamesPlayed" >
        <th mat-header-cell *matHeaderCellDef >G</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.gamesPlayed}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.atBats" >
        <th mat-header-cell *matHeaderCellDef >AB</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.atBats}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.hits" >
        <th mat-header-cell *matHeaderCellDef >H</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.hits}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.doubles" >
        <th mat-header-cell *matHeaderCellDef >2B</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.doubles}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.triples" >
        <th mat-header-cell *matHeaderCellDef >3B</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.triples}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.homeRuns" >
        <th mat-header-cell *matHeaderCellDef >HR</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.homeRuns}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.baseOnBalls" >
        <th mat-header-cell *matHeaderCellDef >BB+IBB</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.baseOnBalls + rosterRec.player.stats?.batting?.intentionalWalks}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.hitByPitch" >
        <th mat-header-cell *matHeaderCellDef >HBP</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.hitByPitch}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.stolenBases" >
        <th mat-header-cell *matHeaderCellDef >SB</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.stolenBases}}
            </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="player.stats.batting.caughtStealing" >
        <th mat-header-cell *matHeaderCellDef >CS</th>
        <td mat-cell *matCellDef="let rosterRec"><span *ngIf="rosterRec.player.stats" class=" d-none d-md-block">{{rosterRec.player.stats?.batting?.caughtStealing}}
            </span>
        </td>
      </ng-container>



    <tr mat-header-row *matHeaderRowDef="['drag_handle', 'lineupPosition', 'player.name', 'player.status', 'abl_runs', 'player.stats.batting.gamesPlayed','player.stats.batting.atBats', 'player.stats.batting.hits', 'player.stats.batting.doubles', 'player.stats.batting.triples', 'player.stats.batting.homeRuns', 'player.stats.batting.baseOnBalls', 'player.stats.batting.hitByPitch', 'player.stats.batting.stolenBases', 'player.stats.batting.caughtStealing']"></tr>
    <tr cdkDrag mat-row *matRowDef="let row; columns: ['drag_handle', 'lineupPosition', 'player.name', 'player.status', 'abl_runs', 'player.stats.batting.gamesPlayed','player.stats.batting.atBats', 'player.stats.batting.hits', 'player.stats.batting.doubles', 'player.stats.batting.triples', 'player.stats.batting.homeRuns', 'player.stats.batting.baseOnBalls', 'player.stats.batting.hitByPitch', 'player.stats.batting.stolenBases', 'player.stats.batting.caughtStealing'];" [ngClass]="{ 'dirty-box': plyrChanged(row)}"></tr>
  </table>
</div>
